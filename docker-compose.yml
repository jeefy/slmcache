version: "3.8"
services:
  slmcache:
    build: .
    # network_mode can be overridden via DOCKER_NETWORK_MODE env var (e.g. "host")
    network_mode: ${DOCKER_NETWORK_MODE:-bridge}
    ports:
      - "8080:8080"
    volumes:
      - ./cache.db:/data/cache.db
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      SLC_DB_PATH: /data/cache.db
      # default to host.docker.internal which resolves to host on many docker setups
      SLM_OLLAMA_URL: "${SLM_OLLAMA_URL:-http://host.docker.internal:11434}"
      SLM_OLLAMA_MODEL: "${SLM_OLLAMA_MODEL:-nomic-embed-text}"
      SLM_REQUIRE_OLLAMA: "${SLM_REQUIRE_OLLAMA:-0}"
